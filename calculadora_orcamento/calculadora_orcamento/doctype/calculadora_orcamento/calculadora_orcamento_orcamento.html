<style>
	.orcamento-header { text-align: center; margin-bottom: 30px; }
	.orcamento-header h2 { margin-bottom: 5px; }
	.orcamento-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
	.orcamento-table th, .orcamento-table td { border: 1px solid #d1d8dd; padding: 8px 12px; text-align: left; }
	.orcamento-table th { background-color: #f5f7fa; font-weight: bold; }
	.orcamento-section { margin: 20px 0; }
	.orcamento-section h4 { border-bottom: 1px solid #d1d8dd; padding-bottom: 5px; }
	.orcamento-product { display: flex; gap: 20px; margin: 20px 0; }
	.orcamento-product-image { flex: 0 0 200px; }
	.orcamento-product-image img { max-width: 200px; max-height: 200px; object-fit: contain; border: 1px solid #d1d8dd; border-radius: 4px; }
	.orcamento-product-details { flex: 1; }
	.orcamento-product-details table { width: 100%; }
</style>

{% set item_name = frappe.db.get_value("Item", doc.item, "item_name") if doc.item else "" %}

<div class="orcamento-header">
	<h2>OR&Ccedil;AMENTO</h2>
	<p><strong>{{ doc.name }}</strong></p>
	<p>Data: {{ frappe.utils.formatdate(frappe.utils.today()) }}</p>
</div>

<div class="orcamento-section">
	<h4>Dados do Cliente</h4>
	<table class="orcamento-table">
		<tr>
			<th>Cliente</th>
			<td>{{ doc.nome or "" }}</td>
		</tr>
		<tr>
			<th>Telefone</th>
			<td>{{ doc.telefone_whatsapp or "" }}</td>
		</tr>
	</table>
</div>

<div class="orcamento-section">
	<h4>Produto</h4>
	<div class="orcamento-product">
		{% if doc.imagem_produto %}
		<div class="orcamento-product-image">
			<img src="{{ doc.imagem_produto }}" alt="Produto">
		</div>
		{% endif %}
		<div class="orcamento-product-details">
			<table class="orcamento-table">
				<tr>
					<th>Item</th>
					<td>{{ item_name or doc.item or "" }}</td>
				</tr>
				{% set descricao = doc.get("descri\u00e7\u00e3o") or "" %}
				{% if descricao %}
				<tr>
					<th>Descri&ccedil;&atilde;o</th>
					<td>{{ descricao }}</td>
				</tr>
				{% endif %}
				{% if doc.gravacoes %}
				<tr>
					<th>Grava&ccedil;&atilde;o</th>
					<td>
						{% for row in doc.gravacoes %}
							{% if row.catalogo_gravacao %}
								{% set metodo = frappe.db.get_value("Catalogo Gravacao", row.catalogo_gravacao, "metodo_gravacao") %}
								{{ metodo }}{% if not loop.last %}, {% endif %}
							{% endif %}
						{% endfor %}
					</td>
				</tr>
				{% endif %}
			</table>
		</div>
	</div>
</div>

<div class="orcamento-section">
	<h4>Valores</h4>
	<table class="orcamento-table">
		<tr>
			<th>Quantidade</th>
			<th>Valor Unit&aacute;rio</th>
			<th>Valor Total</th>
		</tr>
		<tr>
			<td>{{ doc.quantidade or 0 }}</td>
			<td>R$ {{ "%.2f"|format(doc.valor_final_unitario or 0) }}</td>
			<td><strong>R$ {{ "%.2f"|format(doc.valor_final_total or 0) }}</strong></td>
		</tr>
	</table>
</div>

{% set obs = doc.get("observacoes") or "" %}
{% if obs %}
<div class="orcamento-section">
	<h4>Observa&ccedil;&otilde;es</h4>
	<p>{{ obs }}</p>
</div>
{% endif %}
